{
  "nodes": [
    {
      "unique-id": "conference-website",
      "name": "Conference Website",
      "description": "Website to sign up for a conference",
      "node-type": "webclient",
      "interfaces": [
        {
          "unique-id": "conference-website-url",
          "url": "[[ URL ]]"
        }
      ]
    },
    {
      "unique-id": "load-balancer",
      "name": "Load Balancer",
      "description": "Ingress for the Kubernetes cluster",
      "node-type": "network",
      "interfaces": [
        {
          "unique-id": "load-balancer-host-port",
          "host": "[[ HOST ]]",
          "port": -1
        }
      ]
    },
    {
      "unique-id": "attendees-service",
      "name": "Attendees Service",
      "description": "Ingress for the Kubernetes cluster",
      "node-type": "service",
      "interfaces": [
        {
          "unique-id": "attendees-image",
          "image": "[[ IMAGE ]]"
        },
        {
          "unique-id": "attendees-port",
          "port": -1
        }
      ]
    },
    {
      "unique-id": "attendees-store",
      "name": "Attendees Store",
      "description": "Persistent storage for attendees",
      "node-type": "database",
      "interfaces": [
        {
          "unique-id": "database-image",
          "image": "[[ IMAGE ]]"
        },
        {
          "unique-id": "database-port",
          "port": -1
        }
      ]
    },
    {
      "unique-id": "k8s-cluster",
      "name": "Kubernetes Cluster",
      "description": "Kubernetes Cluster with network policy rules enabled",
      "node-type": "system",
      "controls": {
        "security": {
          "description": "Security requirements for the Kubernetes cluster",
          "requirements": [
            {
              "control-requirement-url": "https://calm.finos.org/workshop/controls/micro-segmentation.requirement.json",
              "control-config-url": "[[ CONTROL_CONFIG_URL ]]"
            }
          ]
        }
      }
    }
  ],
  "relationships": [
    {
      "unique-id": "conference-website-load-balancer",
      "description": "Request attendee details",
      "protocol": "HTTPS",
      "relationship-type": {
        "connects": {
          "source": {
            "node": "conference-website"
          },
          "destination": {
            "node": "load-balancer"
          }
        }
      },
      "controls": {
        "security": {
          "description": "Security Controls for the connection",
          "requirements": [
            {
              "control-requirement-url": "https://calm.finos.org/workshop/controls/permitted-connection.requirement.json",
              "control-config-url": "[[ CONTROL_CONFIG_URL ]]"
            }
          ]
        }
      }
    },
    {
      "unique-id": "load-balancer-attendees-service",
      "description": "Forward",
      "protocol": "mTLS",
      "relationship-type": {
        "connects": {
          "source": {
            "node": "load-balancer"
          },
          "destination": {
            "node": "attendees-service"
          }
        }
      },
      "controls": {
        "security": {
          "description": "Security Controls for the connection",
          "requirements": [
            {
              "control-requirement-url": "https://calm.finos.org/workshop/controls/permitted-connection.requirement.json"
            }
          ]
        }
      }
    },
    {
      "unique-id": "attendees-service-attendees-store",
      "description": "Store or request attendee details",
      "protocol": "JDBC",
      "relationship-type": {
        "connects": {
          "source": {
            "node": "attendees-service"
          },
          "destination": {
            "node": "attendees-store"
          }
        }
      },
      "controls": {
        "security": {
          "description": "Security Controls for the connection",
          "requirements": [
            {
              "control-requirement-url": "https://calm.finos.org/workshop/controls/permitted-connection.requirement.json",
              "control-config-url": "[[ CONTROL_CONFIG_URL ]]"
            }
          ]
        }
      }
    },
    {
      "unique-id": "deployed-in-k8s-cluster",
      "description": "Components deployed on the k8s cluster",
      "relationship-type": {
        "deployed-in": {
          "container": "k8s-cluster",
          "nodes": [
            "load-balancer",
            "attendees-service",
            "attendees-store"
          ]
        }
      }
    }
  ],
  "$schema": "https://calm.finos.org/draft/2025-03/meta/calm.json"
}