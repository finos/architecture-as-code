{{!-- Render a node with appropriate shape based on node-type --}}
{{!-- Check if there's a mapping for this node type to a built-in type --}}
{{#with (lookup @root.nodeTypeMap nodeType)}}
{{!-- Use the mapped type for rendering --}}
{{#if (eq this 'actor')}}
{{../id}}([ğŸ‘¤ {{../label}}]):::actor
{{else if (eq this 'database')}}
{{../id}}[(ğŸ—„ï¸ {{../label}})]:::database
{{else if (eq this 'webclient')}}
{{../id}}[[ğŸ’» {{../label}}]]:::webclient
{{else if (eq this 'messagebus')}}
{{../id}}@{shape: h-cyl, label: "ğŸ“¨ {{../label}}"}
class {{../id}} messagebus
{{else if (eq this 'service')}}
{{../id}}[/"âš™ï¸ {{../label}}"/]:::service
{{else if (eq this 'system')}}
{{../id}}[ğŸ¢ {{../label}}]:::system
{{else}}
{{!-- Unknown mapped type, use default --}}
{{../id}}["{{../label}}"]:::node
{{/if}}
{{else}}
{{!-- No mapping, use direct node type or default --}}
{{#if (eq nodeType 'actor')}}
{{id}}([ğŸ‘¤ {{label}}]):::actor
{{else if (eq nodeType 'database')}}
{{id}}[(ğŸ—„ï¸ {{label}})]:::database
{{else if (eq nodeType 'webclient')}}
{{id}}[[ğŸ’» {{label}}]]:::webclient
{{else if (eq nodeType 'messagebus')}}
{{id}}@{shape: h-cyl, label: "ğŸ“¨ {{label}}"}
class {{id}} messagebus
{{else if (eq nodeType 'service')}}
{{id}}[/"âš™ï¸ {{label}}"/]:::service
{{else if (eq nodeType 'system')}}
{{id}}[ğŸ¢ {{label}}]:::system
{{else}}
{{!-- Default rectangle for unknown types --}}
{{id}}["{{label}}"]:::node
{{/if}}
{{/with}}