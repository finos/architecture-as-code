{{!-- Render a node with appropriate shape based on node-type --}}
{{!-- Check if there's a mapping for this node type to a built-in type --}}
{{#with (lookup @root.nodeTypeMap nodeType)}}
{{!-- Use the mapped type for rendering --}}
{{#if (eq this 'actor')}}
{{{mermaidId ../id}}}([ğŸ‘¤ {{../label}}]):::actor
{{else if (eq this 'database')}}
{{{mermaidId ../id}}}[(ğŸ—„ï¸ {{../label}})]:::database
{{else if (eq this 'webclient')}}
{{{mermaidId ../id}}}[[ğŸ’» {{../label}}]]:::webclient
{{else if (eq this 'messagebus')}}
{{{mermaidId ../id}}}@{shape: h-cyl, label: "ğŸ“¨ {{../label}}"}
class {{{mermaidId ../id}}} messagebus
{{else if (eq this 'service')}}
{{{mermaidId ../id}}}[/"âš™ï¸ {{../label}}"/]:::service
{{else if (eq this 'system')}}
{{{mermaidId ../id}}}[ğŸ¢ {{../label}}]:::system
{{else}}
{{!-- Unknown mapped type, use default --}}
{{{mermaidId ../id}}}["{{../label}}"]:::node
{{/if}}
{{else}}
{{!-- No mapping, use direct node type or default --}}
{{#if (eq nodeType 'actor')}}
{{{mermaidId id}}}([ğŸ‘¤ {{label}}]):::actor
{{else if (eq nodeType 'database')}}
{{{mermaidId id}}}[(ğŸ—„ï¸ {{label}})]:::database
{{else if (eq nodeType 'webclient')}}
{{{mermaidId id}}}[[ğŸ’» {{label}}]]:::webclient
{{else if (eq nodeType 'messagebus')}}
{{{mermaidId id}}}@{shape: h-cyl, label: "ğŸ“¨ {{label}}"}
class {{{mermaidId id}}} messagebus
{{else if (eq nodeType 'service')}}
{{{mermaidId id}}}[/"âš™ï¸ {{label}}"/]:::service
{{else if (eq nodeType 'system')}}
{{{mermaidId id}}}[ğŸ¢ {{label}}]:::system
{{else}}
{{!-- Default rectangle for unknown types --}}
{{{mermaidId id}}}["{{label}}"]:::node
{{/if}}
{{/with}}